#!/bin/sh
# Pre-commit hook to block secrets, env files, and SQLite DBs

echo "🔒 Running pre-commit checks..."

# Block only files literally named ".env"
if git diff --cached --name-only | grep -qE '^\.env$'; then
  echo "❌ ERROR: .env file detected in commit. Remove it before committing."
  exit 1
fi

# Block only staged database files (not local dev files)
if git diff --cached --name-only | grep -qE '\.(db|sqlite3)$'; then
  echo "❌ ERROR: Database file staged for commit. Remove it before committing."
  exit 1
fi

# Block secrets.json
if git diff --cached --name-only | grep -q 'secrets.json'; then
  echo "❌ ERROR: secrets.json detected in commit."
  exit 1
fi

echo "✅ All checks passed. Proceeding with commit."

